
(import "!glyphs.lisp")

[d ← \⎕r⊂ (ucs '(10)) \file-get "aoc2021/4-1.in"]
[d1 ← \:⍎π@⎕s⊂ (∊↑ d) ","]
[d2 ← \::(#0 :⍎π@$(⎕s⊂ _ " +")@↑⍕↓) \#(:∊↓@⊆ :$(= "") #0) d]
[l-t ←∘ (l) \:(φ \:$(⊃ x) l) \⍳@⍴@∊↑ l]
[f-s ←∘ (b) \∨=@∊@#(,^:$(= \↑ (⍴ b) 1) #0 l-t) b]
[m-n ←∘ (b n) \/ (:$(/= -1)@φ⍳ (∊ b) n) \⍴ b]
[s ← \:(φ \∊⊃ $(f-s@m-n x) \∘.⍋ d1) d2]
[wi ← \#(∊↑@φ⍳ ,@$(⌿ ⌊) #0) \:⍴ s]
[ws ← \⊃ wi s] [wb ← \⊃ wi d2]
(⍞@* (+/@∊@:φ/ (::~@m-n wb ws) wb) \∊↑@⌽ ws)


